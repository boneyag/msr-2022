{"tags": ["java", "android", "json", "android-activity", "httprequest"], "comments": [{"score": 0, "creation_date": 1458710962, "post_id": 36170445, "comment_id": 59977603, "body": "Also use try catch block"}, {"score": 0, "creation_date": 1458711090, "post_id": 36170445, "comment_id": 59977643, "body": "may be your response is not in json format"}, {"score": 0, "creation_date": 1458711147, "post_id": 36170445, "comment_id": 59977665, "body": "but it is, i echo a json array form my php with key &#39;result&#39; value : true."}, {"score": 0, "creation_date": 1458711148, "post_id": 36170445, "comment_id": 59977666, "body": "at org.json.JSON.typeMismatch(JSON.java:111) Json response not match show response and model class"}, {"score": 0, "creation_date": 1458711199, "post_id": 36170445, "comment_id": 59977683, "body": "That means Log your <code>result</code> and post"}, {"score": 0, "creation_date": 1458711283, "post_id": 36170445, "comment_id": 59977711, "body": "I&#39;ve gotten this error before and it may be that the variable &quot;result&quot; doesn&#39;t contain valid JSON syntax. So yeah, do as the others are saying and display the contents of &quot;results&quot;."}, {"score": 0, "creation_date": 1458711364, "post_id": 36170445, "comment_id": 59977743, "body": "this is the output from my php  $arr = array(&#39;result&#39; =&gt; true);                         echo json_encode($arr); Is this not correct ? which for me outputs {&quot;result&quot;:true}"}, {"score": 0, "creation_date": 1458711455, "post_id": 36170445, "comment_id": 59977773, "body": "@Aboogie &quot;result&quot; should be storing JSON text, something like: <code>&quot;{&quot;name&quot;:&quot;John&quot;, &quot;id&quot;:&quot;12345&quot;}&quot;</code>"}, {"score": 0, "creation_date": 1458711779, "post_id": 36170445, "comment_id": 59977869, "body": "I did that, but oddly enough, response doesn&#39;t output anything. can&#39;t understand why. so Log.i(&quot;data&quot;, response.toString()); doesn&#39;t display anything."}, {"score": 0, "creation_date": 1458711879, "post_id": 36170445, "comment_id": 59977906, "body": "Then there is no result retrieved."}, {"score": 0, "creation_date": 1458711880, "post_id": 36170445, "comment_id": 59977907, "body": "@Aboogie actually I&#39;m wrong, booleans don&#39;t need to be in quotes. My bad ha. I&#39;m not 100% sure but it seems the bug is with your result variable."}, {"score": 0, "creation_date": 1458712376, "post_id": 36170445, "comment_id": 59978101, "body": "@Ghost_Stark would say on the android code or the php, because I can&#39;t seem to see any errors, especially when I do see json output from php . should I post my php as well ? (I have posted it)"}, {"score": 0, "creation_date": 1458712905, "post_id": 36170445, "comment_id": 59978274, "body": "Can you show what is being returned after these lines: <code>Log.i(&quot;Im Here&quot;, &quot;result&quot;);                  String result = response.toString();</code> ? The value of <code>response.toString()</code> to be specific."}, {"score": 0, "creation_date": 1458713158, "post_id": 36170445, "comment_id": 59978369, "body": "Nothing is being displayed from response. what I am concerned with is that the url with the php should be running to the point that the queries should be happening but they are not occurring. which is weird."}, {"score": 0, "creation_date": 1458739080, "post_id": 36170445, "comment_id": 59993645, "body": "Did you check your script by running it your browser"}, {"score": 0, "creation_date": 1458804940, "post_id": 36170445, "comment_id": 60024074, "body": "my scripts works if I give it all the inputs in the browser and it outputs the result."}], "answers": [{"comments": [{"score": 0, "creation_date": 1458885871, "post_id": 36182898, "comment_id": 60062202, "body": "Hi, trying  echo [&quot;result&quot;:&quot;true&quot;] in php gives me an error for the colon. I have tried numerous methods in php but it seems that none is working. anything else of why theres no response coming on the android side?"}, {"score": 0, "creation_date": 1458886596, "post_id": 36182898, "comment_id": 60062416, "body": "My other observation that is concerning me is that response is not receiving anything. any ideas on why this could be doing what it is doing ?"}], "score": 0, "last_activity_date": 1458794284, "last_edit_date": 1458794284, "answer_id": 36182898, "question_id": 36170445, "body": "<p>before anything else.\nI have some questions.</p>\n\n<ol>\n<li>are you using your phone to connect to your local server (xampp)? if yes then SERVER_ADDRESS should be your IP Address.</li>\n</ol>\n\n<p>OR if you're using a Virtual Device then SERVER_ADDRESS should be <a href=\"http://10.0.2.2/\" rel=\"nofollow\">http://10.0.2.2/</a></p>\n\n<ol start=\"2\">\n<li>you are posting a data.\nyou should use $_POST[] not $_GET[] (though it will work BUT! proper coding techniques and practices should be used ALWAYS.\nAND\n<code>connection.setRequestMethod(\"POST\");</code></li>\n</ol>\n\n<p>that's a POST so use $_POST[].</p>\n\n<p>okay about the error.</p>\n\n<blockquote>\n  <p>org.json.JSONException: Value \n</blockquote>\n\n<p>you will see this error BECAUSE.\nthe page you are posting to is not displaying a JSON/JSON Array Object.\nmeaning you have other texts in the page. like error display failed to connect or failed to register\nor any other text beside the JSON/JSON Array.\nthe page SHOULD ONLY display JSON/JSON Array whether its a success or failure. you should display a JSON/JSON Array.</p>\n\n<p>to avoid this.\nwhen you successfully register echo a JSON/JSON Array text. (it has a success text in JSON format.)\nif you failed to register STILL! echo a JSON/JSON Array text. (it has an failed text in JSON format.)</p>\n\n<p>LIKE THIS</p>\n\n<p>ONLY JSON Format SHOULD BE displayed</p>\n\n<p><code>if (Register True) {\n     echo [\"result\":\"true\"]\n} else {\n     echo [\"result\":\"failed\"]\n}</code></p>\n\n<p>then in your Android Code</p>\n\n<p><code>String isAuth = jsonObject.getString(\"result\");\nauthenticate = isAuth.equals(\"true\");</code></p>\n\n<p>AVOID any other text in where you are trying to post.</p>\n"}, {"score": 0, "last_activity_date": 1459176556, "answer_id": 36264756, "question_id": 36170445, "body": "<p>Because one of my files was commented before the start of the php script, the output of the php file was the comment which is not a JSON object, which is why my android was not understanding the input from the php return. I was able to delete the comment and I was able to receive from my php. Thanks all who tried to help !I appreciate it.</p>\n"}], "is_answered": true, "answer_count": 2, "score": 0, "last_activity_date": 1459176556, "creation_date": 1458710826, "question_id": 36170445, "title": "Android Issue with JSonObect", "body": "<p>I am having problem with a JsonObject and I can't seem to figure out why. </p>\n\n<p>Here is the Error:</p>\n\n<pre><code>03-23 01:19:58.128 11981-12144/com.example.admirmonteiro.login W/System.err: org.json.JSONException: Value &lt;!--this of type java.lang.String cannot be converted to JSONObject\n03-23 01:19:58.133 11981-12144/com.example.admirmonteiro.login W/System.err:     at org.json.JSON.typeMismatch(JSON.java:111)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at org.json.JSONObject.&lt;init&gt;(JSONObject.java:160)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at org.json.JSONObject.&lt;init&gt;(JSONObject.java:173)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at com.example.admirmonteiro.login.signUpActivity$JSONAsyncRegisterTask.postData(signUpActivity.java:225)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at com.example.admirmonteiro.login.signUpActivity$JSONAsyncRegisterTask.doInBackground(signUpActivity.java:145)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at com.example.admirmonteiro.login.signUpActivity$JSONAsyncRegisterTask.doInBackground(signUpActivity.java:111)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at android.os.AsyncTask$2.call(AsyncTask.java:295)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at java.util.concurrent.FutureTask.run(FutureTask.java:237)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:234)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1113)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)\n03-23 01:19:58.134 11981-12144/com.example.admirmonteiro.login W/System.err:     at java.lang.Thread.run(Thread.java:818)\n</code></pre>\n\n<p>This is my code(Activity)All Im trying to do is send the parameters to be posted on the database :</p>\n\n<pre><code>public class signUpActivity extends AppCompatActivity {\n\n    boolean result = false, authenticate = false;\n    private static final String SERVER_ADDRESS = \"http://eclipsegym.pe.hu/\";\n\n\n     EditText signUpEmail, signUpPassword, firstname, lastname, department;\n     Button btn_signUp;\n     RequestQueue requestQueue;\n\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sign_up);\n\n        signUpEmail = (EditText) findViewById(R.id.signUp_email);\n        signUpPassword = (EditText) findViewById(R.id.signUp_password);\n        firstname = (EditText) findViewById(R.id.input_firstname);\n        lastname = (EditText) findViewById(R.id.input_lastname);\n        department = (EditText) findViewById(R.id.departmentId);\n        btn_signUp = (Button) findViewById(R.id.btn_signup);\n\n        requestQueue = Volley.newRequestQueue(getApplicationContext());\n\n\n\n        btn_signUp.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n\n                String firstName =firstname.getText().toString();\n                String lastName = lastname.getText().toString();\n                String email = signUpEmail.getText().toString();\n                String password = signUpPassword.getText().toString();\n                String apt = department.getText().toString();\n                String userType = \"1\";\n                User registeredData = new User(firstName,lastName,password,email,apt,userType);\n\n                registerUser(registeredData);\n\n            }\n\n        });\n\n    }\n\n    private void registerUser(User user) {\n\n        Log.i(\"1name\",user.firstName);\n        Log.i(\"lname\",user.lastName);\n        Log.i(\"apt\",user.department);\n        Log.i(\"email\",user.email);\n        Log.i(\"pw\",user.password);\n\n        if (user.firstName.equals(\"\") || user.lastName.equals(\"\") || user.department.equals(\"\") || user.email.equals(\"\") || user.password.equals(\"\")) {\n            Toast.makeText(getApplicationContext(), \"Please fill in the fields\", Toast.LENGTH_SHORT).show();\n        } else if (!user.password.equals(user.password)) {\n            Toast.makeText(getApplicationContext(), \"Password and Confirm Password does not match\", Toast.LENGTH_SHORT).show();\n        } else {\n            new JSONAsyncRegisterTask().execute(user.firstName, user.lastName, user.password, user.email,user.department,user.userType, SERVER_ADDRESS);\n        }\n\n\n\n    }\n\n    private class JSONAsyncRegisterTask extends AsyncTask&lt;String, Void, Boolean&gt; {\n\n        ProgressDialog progressDialog;\n\n        @Override\n        protected void onPreExecute() {\n            super.onPreExecute();\n            progressDialog = new ProgressDialog(signUpActivity.this);\n            progressDialog.setTitle(\"Connecting to Server\");\n            progressDialog.setMessage(\"Processing Registration!! HOLD ON BROTHER!\");\n            progressDialog.show();\n            progressDialog.setCancelable(false);\n        }\n\n        @Override\n        protected Boolean doInBackground(String... params) {\n\n            String urlParameters = null;\n            try {\n                Log.d(\"hey\", params.toString());\n                urlParameters = \"firstName=\" + URLEncoder.encode(params[0], \"UTF-8\") +\n                        \"&amp;lastName=\" + URLEncoder.encode(params[1], \"UTF-8\") +\n                        \"&amp;password=\" + URLEncoder.encode(params[2], \"UTF-8\")+\n                        \"&amp;email=\" + URLEncoder.encode(params[3], \"UTF-8\") +\n                        \"&amp;department=\" + URLEncoder.encode(params[4], \"UTF-8\") +\n                        \"&amp;userType=\" + URLEncoder.encode(params[5], \"UTF-8\")\n                ;\n\n            } catch (UnsupportedEncodingException e) {\n                e.printStackTrace();\n            }\n\n            try {\n                printIt(\"i\",\"before post Data\");\n                result = postData(urlParameters, params[6]);\n            } catch (JSONException e) {\n                e.printStackTrace();\n            }\n\n            return result;\n        }\n\n        @Override\n        protected void onPostExecute(Boolean result) {\n\n            progressDialog.cancel();\n\n            if(result){\n                Toast.makeText(signUpActivity.this, \"Registeration Successful\", Toast.LENGTH_LONG).show();\n                    Toast.makeText(getApplicationContext(), \"Registration Failed\", Toast.LENGTH_LONG).show();\n                    AlertDialog.Builder dialogBuilder = new AlertDialog.Builder(signUpActivity.this);\n                    dialogBuilder.setMessage(\"Registration Success!\");\n                    dialogBuilder.setPositiveButton(\"OK...\", null);\n                    dialogBuilder.show();\n                Intent intent =  new Intent(signUpActivity.this, MainActivity.class);\n                startActivity(intent);\n                finish();\n            } else {\n                Toast.makeText(getApplicationContext(), \"Registration Failed\", Toast.LENGTH_LONG).show();\n                AlertDialog.Builder dialogBuilder = new AlertDialog.Builder(signUpActivity.this);\n                dialogBuilder.setMessage(\"Registration Failure!\");\n                dialogBuilder.setPositiveButton(\"OK...\", null);\n                dialogBuilder.show();\n            }\n\n\n        }\n\n        public boolean postData(String urlParameters, String strUrl) throws JSONException {\n\n            Log.i(\"Im Here\", \"Post Data Method\");\n            URL url;\n\n            HttpURLConnection connection;\n            Log.i(\"urlLink\", strUrl);\n            Log.d(\"urlParams\", urlParameters);\n\n            try {\n                String link = strUrl + \"signup_ac.php\";\n                Log.d(\"urlLink\", link);\n                url = new URL(link);\n                connection = (HttpURLConnection)url.openConnection();\n                connection.setRequestMethod(\"POST\");\n                connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n                connection.setRequestProperty(\"Content-Length\", \"\" + Integer.toString(urlParameters.getBytes().length));\n                connection.setRequestProperty(\"Content-Language\", \"en-US\");\n                connection.setUseCaches(false);\n                connection.setDoInput(true);\n                connection.setDoOutput(false);\n\n                Log.i(\"Im Here\", \"sending stream\");\n\n                DataOutputStream dataOutputStream = new DataOutputStream(connection.getOutputStream());\n                dataOutputStream.writeBytes(urlParameters);\n                dataOutputStream.flush();\n                dataOutputStream.close();\n\n                Log.i(\"Im Here\", \"input stream\");\n                InputStream inputStream = connection.getInputStream();\n                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream, HTTP.UTF_8),8);\n                String line;\n\n                StringBuilder response = new StringBuilder();\n                while ((line = bufferedReader.readLine()) != null) {\n                    response.append(line);\n                    response.append('\\r');\n                }\n                Log.i(\"data\", response.toString());\n                bufferedReader.close();\n                Log.i(\"data2\", response.toString());\n\n                Log.i(\"Im Here\", \"result\");\n\n                String result = response.toString();\n                JSONObject jsonObject = new JSONObject(result);\n\n                Log.i(\"Im Here\", \"auth\");\n                String isAuth = jsonObject.getString(\"result\");\n\n                authenticate = isAuth.equals(\"true\");\n            } catch (java.io.IOException e) {\n                e.printStackTrace();\n            }\n\n            return  authenticate;\n        }\n    }\n\n\n    public void printIt (String leter ,String value){\n\n\n        if (leter==\"i\") {\n            Log.i(\"value:\", value);\n        }else if(leter==\"d\"){\n            Log.d(\"d\",value);\n\n        }\n    }\n\n} \n</code></pre>\n\n<p>I can't seem to figure out why this is the output, I have tried multiple things with the JSON but it doesn't seem to be working. </p>\n\n<p>Here is my php code that returns the json array with result : true .</p>\n\n<pre><code>&lt;?php\ninclude \"connect.php\";\ninclude \"generalUtility.php\";\nglobal $UsersTable, $administratorsEmail,$doctorsTable,$mysql_database,$PatientsTable,$connect;\n$UsersTabledoctorsID = 0;\n\n\n\n$firstName=$_GET[\"firstName\"];\n$lastName=$_GET[\"lastName\"];\n$email=$_GET[\"email\"];\n$password=$_GET[\"password\"];\n$department=$_GET[\"department\"];\n$userType=$_GET[\"userType\"];\n\nif (isset($firstName,$lastName,$email,$password,$department,$userType)){\n    if (!empty($firstName) &amp;&amp; !empty($lastName) &amp;&amp; !empty($email) &amp;&amp; !empty($password) &amp;&amp; !empty($department)&amp;&amp; !empty($userType)) {\n        $userType = (int) $userType ;\n        /** Insert data into database **/\n        $encrypted_password = md5($password);\n        if (emailValidation($email)) {\n            if (doesUserExist($email)) {\n                $arr = array('result' =&gt; false);\n                echo json_encode($arr);\n            } else {\n                //Queries \n                $sql = \"INSERT INTO $mysql_database.$UsersTable (firstName, lastName, password, email,userType)VALUES ('$firstName', '$lastName', '$encrypted_password','$email','$userType')\";\n                $res = mysql_query($sql, $connect) or die(mysql_error());\n                if ($res) {\n//                    echo \" Query ? : UserTable\" . $res . \" \\n\";\n                    $UsersTabledoctorsID = mysql_insert_id();\n                    //echo \"Usersdoctors: \".$UsersTabledoctorsID.\"\\n\";\n                }else{\n                    echo \"UsersDoctors: No ID \\n\";\n\n                }\n                $sql2 = \"INSERT INTO $mysql_database.$doctorsTable (Users_idUser,department)VALUES ('$UsersTabledoctorsID', '$department')\";\n                $res2 = mysql_query($sql2, $connect) or die(mysql_error());\n                if ($res2) {\n//                    echo \" Query ? : doctor Table\" . $res2 . \" \\n\";\n                    $doctorsID = mysql_insert_id();\n                    //echo \"doctors: \".$doctorsID.\"\\n\";\n                }else{\n\n                    echo \"doctors: No ID \\n\";\n                }\n\n                if ($res &amp;&amp; $res2) {\n                    global $domain;\n                    // ---------------- SEND MAIL FORM ----------------\n                    // send e-mail to ...\n                    $pwLink = $domain.\"/setAccountActive.php?ID=\" . $UsersTabledoctorsID . \"&amp;email=\". $email;\n                    $pwLinkDeny = $domain.\"/doNotActivateAccount.php?ID=\" . $UsersTabledoctorsID .\"&amp;email=\". $email;\n                    $to=$administratorsEmail;\n                    $header=\"From: support@\".$domain.\".com\";\n                    $subject = 'Administrator : Doctor Request !';\n                    $body = &lt;&lt;&lt;EMAIL\nConfirm Doctor $firstName $lastName Account ! \\r\\n\";\nClick on this link to activate your account ! $pwLink !\\r\\n\"\nClick to not activate this Account! $pwLinkDeny !\\r\\n\"\nEMAIL;\n\n                } else {\n                    echo json_encode(\" Queries didnt finish \\n\");\n                } \n\n            }\n        }else{\n            echo \"email is not valid \\n\";\n        }\n    }\n    $sentmail = mail($to, $subject, $body, $header);\n    if($sentmail){\n//                        echo \"an Email has been sent to the Administrator\";\n        $arr = array('result' =&gt; \"true\");\n        echo json_encode($arr);\n    } else {\n        setInactive($UsersTabledoctorsID);\n        echo \"Cannot for unforseeable reasons verify your account\";\n    }\n\n}else{\n   echo \"something not able to be set!\\n\"; \n}\n\n?&gt;\n</code></pre>\n"}