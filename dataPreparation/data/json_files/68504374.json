{"tags": ["arrays", "json", "append", "jq"], "comments": [{"post_id": 68504374, "comment_id": 121069896, "body": "What if a key named &quot;array&quot; appears in multiple objects?"}, {"post_id": 68504374, "comment_id": 121075677, "body": "Why did you tag this with &quot;linux&quot;? Did you read the tag&#39;s description?"}], "answers": [{"answer_id": 68504495, "question_id": 68504374, "body": "<p>Well, does something like this work for you?</p>\n<pre><code>jq '.[0].array += [&quot;string3&quot;]' test.json\n</code></pre>\n<p>I see this response, which looks pretty much like what I would want:</p>\n<pre><code>[\n  {\n    &quot;array&quot;: [\n      &quot;string1&quot;,\n      &quot;string2&quot;,\n      &quot;string3&quot;\n    ]\n  },\n  {\n    &quot;object1&quot;: {\n      &quot;subobject1&quot;: {},\n      &quot;subobject2&quot;: {}\n    }\n  },\n  {\n    &quot;object2&quot;: {}\n  }\n]\n</code></pre>\n<p>EDIT 1:\nI like the more general solutions provided by @peak particularly the first one:</p>\n<pre><code>map( if .array then .array += [&quot;string3&quot;] else . end)\n</code></pre>\n<p>Here's a <a href=\"https://jqplay.org/s/bzuuaVHtYK\" rel=\"nofollow noreferrer\">snippet</a> you can experiment with. It's easy to see how you could insert the new string into the second contained array rather than the first with:</p>\n<pre><code> map( if .array2 then .array2 += [&quot;string3&quot;] else . end)\n</code></pre>\n"}, {"answer_id": 68505450, "question_id": 68504374, "body": "<p>Depending on your requirements, you may wish to consider:</p>\n<pre><code>map( if .array then .array += [&quot;string3&quot;] else . end)\n</code></pre>\n<p>or even:</p>\n<pre><code>walk( if type == &quot;object&quot; and .array then .array += [&quot;string3&quot;] else . end)\n</code></pre>\n<p>If you only want the first occurrence at the top-level to be affected:</p>\n<pre><code>(first(.[]|.array // empty)) += [&quot;string3&quot;]\n</code></pre>\n"}, {"answer_id": 68508003, "question_id": 68504374, "body": "<p>You can try this to find object by key <code>array</code> and append there</p>\n<pre><code>jq '.[] | select(has(&quot;array&quot;)).array += [&quot;string3&quot;]' test.json\n</code></pre>\n<p>This is what the response looks like</p>\n<pre><code>{\n  &quot;array&quot;: [\n    &quot;string1&quot;,\n    &quot;string2&quot;,\n    &quot;string3&quot;\n  ]\n}\n{\n  &quot;object1&quot;: {\n    &quot;subobject1&quot;: {},\n    &quot;subobject2&quot;: {}\n  }\n}\n{\n  &quot;object2&quot;: {}\n}\n</code></pre>\n"}], "is_answered": true, "answer_count": 3, "last_activity_date": 1627510925, "question_id": 68504374, "title": "Using jq, how to append an element to an array without it updating every other object?", "body": "<p>I have a test.json file that looks like this:</p>\n<pre><code>[\n  {\n    &quot;array&quot;: [\n      &quot;string1&quot;,\n      &quot;string2&quot;\n    ]\n  },\n  {\n    &quot;object1&quot;: {\n      &quot;subobject1&quot;: {},\n      &quot;subobject2&quot;: {}\n    }\n  },\n  {\n    &quot;object2&quot;: {}\n  }\n]\n</code></pre>\n<p>I'm trying to append an element, <code>string3</code> into <code>array</code>. I've tried the following commands:</p>\n<pre><code>$ jq '.[] | .array |= . + [&quot;string3&quot;]' test.json\n$ jq '.[] | .array += [&quot;string3&quot;]' test.json\n</code></pre>\n<p>What I expect is this, <code>string3</code> only being appended to <code>array</code>:</p>\n<pre><code>{\n  &quot;array&quot;: [\n    &quot;string1&quot;,\n    &quot;string2&quot;,\n    &quot;string3&quot;\n  ]\n}\n{\n  &quot;object1&quot;: {\n    &quot;subobject1&quot;: {},\n    &quot;subobject2&quot;: {}\n  },\n}\n{\n  &quot;object2&quot;: {},\n}\n</code></pre>\n<p>However, I get these as the actual result, where the <code>array</code> array is being added to all objects:</p>\n<pre><code>{\n  &quot;array&quot;: [\n    &quot;string1&quot;,\n    &quot;string2&quot;,\n    &quot;string3&quot;\n  ]\n}\n{\n  &quot;object1&quot;: {\n    &quot;subobject1&quot;: {},\n    &quot;subobject2&quot;: {}\n  },\n  &quot;array&quot;: [\n    &quot;string3&quot;\n  ]\n}\n{\n  &quot;object2&quot;: {},\n  &quot;array&quot;: [\n    &quot;string3&quot;\n  ]\n}\n</code></pre>\n<p>How can I append to the one array <code>array</code> without affecting any other objects in the file?</p>\n<p>I'm using jq version 1.6.</p>\n"}