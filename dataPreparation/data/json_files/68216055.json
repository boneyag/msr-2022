{"tags": ["python", "django", "email", "icalendar"], "comments": [{"post_id": 68216055, "comment_id": 120781634, "body": "Have you had a look at: <a href=\"https://stackoverflow.com/questions/4823574/sending-meeting-invitations-with-python\" title=\"sending meeting invitations with python\">stackoverflow.com/questions/4823574/&hellip;</a>"}, {"post_id": 68216055, "comment_id": 120819550, "body": "I have @bdbd, it&#39;s out of date, 8 years old, (packages have changed since it was written) and rewriting it with the new packaging, it crashes when I try it, on msg.as_string(). It is also incomplete: for example it creates a ical_atch but it never gets used. I&#39;m referring here to the most upvoted answer from Auberon Vacher"}, {"post_id": 68216055, "comment_id": 120833739, "body": "What&#39;s an ics calendar attachment? Don&#39;t see why you can&#39;t do the first 2 with django&#39;s native email module."}], "answers": [{"answer_id": 68381267, "question_id": 68216055, "body": "<p>Django has built-in solution based on python's smtplib:</p>\n<p><a href=\"https://docs.djangoproject.com/en/3.2/topics/email/\" rel=\"nofollow noreferrer\">https://docs.djangoproject.com/en/3.2/topics/email/</a></p>\n<p>You need to provide some credentials to your smtp server(gmail, mailgun etc) in settings and after that you can use django.core.mail module.</p>\n<p>For attaching stuff you can use EmailMessage.attach() or attach_file()</p>\n<p><a href=\"https://docs.djangoproject.com/en/3.2/topics/email/#django.core.mail.EmailMessage\" rel=\"nofollow noreferrer\">https://docs.djangoproject.com/en/3.2/topics/email/#django.core.mail.EmailMessage</a></p>\n"}, {"answer_id": 68415808, "question_id": 68216055, "body": "<p>Start by creating a .ics file, this can ofcourse also be done by a python script to generate dynamic .ics files.</p>\n<p><strong>.ics file</strong></p>\n<p>More information about <a href=\"https://en.wikipedia.org/wiki/ICalendar\" rel=\"nofollow noreferrer\">iCalendar</a>: basic information and general templates (see example below).</p>\n<pre><code>BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//hacksw/handcal//NONSGML v1.0//EN\nBEGIN:VEVENT\nUID:uid1@example.com\nDTSTAMP:19970714T170000Z\nORGANIZER;CN=John Doe:MAILTO:john.doe@example.com\nDTSTART:19970714T170000Z\nDTEND:19970715T035959Z\nSUMMARY:Bastille Day Party\nGEO:48.85299;2.36885\nEND:VEVENT\nEND:VCALENDAR\n</code></pre>\n<p>You can also <a href=\"https://ical.marudot.com\" rel=\"nofollow noreferrer\">generate</a> your own iCalendar if you find that easier (see generated example below).</p>\n<pre><code>BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//ical.marudot.com//iCal Event Maker\nCALSCALE:GREGORIAN\nBEGIN:VTIMEZONE\nTZID:Europe/Berlin\nLAST-MODIFIED:20201011T015911Z\nTZURL:http://tzurl.org/zoneinfo-outlook/Europe/Berlin\nX-LIC-LOCATION:Europe/Berlin\nBEGIN:DAYLIGHT\nTZNAME:CEST\nTZOFFSETFROM:+0100\nTZOFFSETTO:+0200\nDTSTART:19700329T020000\nRRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU\nEND:DAYLIGHT\nBEGIN:STANDARD\nTZNAME:CET\nTZOFFSETFROM:+0200\nTZOFFSETTO:+0100\nDTSTART:19701025T030000\nRRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU\nEND:STANDARD\nEND:VTIMEZONE\nBEGIN:VEVENT\nDTSTAMP:20210716T221958Z\nUID:20210716T221958Z-901688629@marudot.com\nDTSTART;TZID=Europe/Berlin:20210717T120000\nDTEND;TZID=Europe/Berlin:20210717T160000\nSUMMARY:Stack Overflow\nDESCRIPTION:iCalendar example for Stack Overflow user Ciske\\n\nLOCATION:Amsterdam\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:Stack Overflow\nTRIGGER:-PT1H\nEND:VALARM\nEND:VEVENT\nEND:VCALENDAR\n</code></pre>\n<p><strong>Django settings.py</strong></p>\n<pre><code>EMAIL_HOST = SMTP server.\nEMAIL_HOST_USER = Login credentials for the SMTP server.\nEMAIL_HOST_PASSWORD = Password credential for the SMTP server.\nEMAIL_PORT = SMTP server port.\nEMAIL_USE_TLS or _SSL = True if secure connection.\n</code></pre>\n<p><strong>Django views.py</strong></p>\n<p>Send email with .ics file as attachment.</p>\n<pre><code>from django.core.mail import EmailMessage\n\n# Send email with attachment\nemail = EmailMessage(\n    'Subject',\n    'Email body',\n    'from@example.com',\n    ['to@example.com']\n)\nemail.attach_file('assets/invite.ics', 'text/calendar')\nemail.send()\n</code></pre>\n<p>You can even add an .html file to your email.</p>\n<pre><code>from django.core.mail import EmailMultiAlternatives\nfrom django.template.loader import render_to_string\n\nhtml_content = render_to_string('assets/email.html', context)\n\nemail = EmailMultiAlternatives('Subject', 'Email body', 'from@example.com', [to@example.com])\nemail.attach_alternative(html_content, 'text/html')\nemail.attach_file('assets/invite.ics', 'text/calendar')\nemail.send()\n</code></pre>\n"}, {"answer_id": 68418500, "question_id": 68216055, "body": "<p>You can try using <code>mark_safe()</code> it renders the js,html code as a string to a html page .\nI had used it for customizing Django admin.\nCheck the example below :</p>\n<pre><code>some_sample_string = '''&lt;h1&gt;This is some sample &lt;/h1&gt;'''\nmy_sample_html = mark_safe(some_sample_string)\n</code></pre>\n<p>you can design a page in HTML add some custom designing to it and then return the mark_safe byte object to HTML or any web page and tag it there it will work.</p>\n<p>you can check these links it might be a help for you</p>\n<p><a href=\"https://www.kite.com/python/docs/django.utils.safestring.mark_safe\" rel=\"nofollow noreferrer\">https://www.kite.com/python/docs/django.utils.safestring.mark_safe</a></p>\n<p><a href=\"https://stackoverflow.com/questions/25083258/return-mark-safe-string-from-str\">Return mark_safe string from __str__</a></p>\n<p><a href=\"https://www.fullstackpython.com/django-utils-safestring-mark-safe-examples.html\" rel=\"nofollow noreferrer\">https://www.fullstackpython.com/django-utils-safestring-mark-safe-examples.html</a></p>\n<p><a href=\"https://docs.djangoproject.com/en/3.0/_modules/django/utils/html/\" rel=\"nofollow noreferrer\">https://docs.djangoproject.com/en/3.0/_modules/django/utils/html/</a></p>\n"}], "is_answered": true, "answer_count": 3, "last_activity_date": 1626539521, "question_id": 68216055, "title": "Sending a text + HTML email with a calendar ICS attachment in Django or Python", "body": "<p>I've been searching for a library or at least functional snippet of code that lets me send an e-mail from Django (or at least in Python) with text content, HTML content, and an ICS calendar attachment that is recognized by every major e-mail client. For my particular use case it's enough if the user is offered an 'add to calendar' button.</p>\n<p>I feel like this should be a solved problem by now, but I'm only finding answers that refer to libraries that aren't being maintained or that are outdated or incomplete in some other way. I've tested a couple of snippets that will attach an ICS file, but G-mail doesn't give me the option of adding it to the calendar like it usually does.</p>\n<p>Is there a ready made solution that I'm missing?</p>\n"}