{"tags": ["regex", "google-sheets", "formula"], "answers": [{"answer_id": 68089216, "question_id": 68087774, "body": "<p>try:</p>\n<pre><code>=ARRAYFORMULA(IFERROR(SPLIT(FLATTEN(\n QUERY(TRANSPOSE(IF(ISURL(SPLIT(A2, &quot; &quot;)), \n SPLIT(A2, &quot; &quot;), )),,9^9)), &quot; &quot;)))\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/XmqMW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XmqMW.png\" alt=\"enter image description here\" /></a></p>\n"}, {"answer_id": 68089220, "question_id": 68087774, "body": "<p>You haven't shown the entire string, so we don't know what markers there are to work with. That said, you can try this (assuming your raw string were in A2):</p>\n<p><code>=REGEXEXTRACT(A2,REPT(&quot;.+(http[^\\s,]+)&quot;,2))</code></p>\n<p>The output will require <em>two</em> horizontal cells. So if you place this in B2, make sure that both B2 and C2 are free first.</p>\n<p>If that doesn't work, consider sharing the <em>entire</em> string you are trying to break.</p>\n"}, {"answer_id": 68089253, "question_id": 68087774, "body": "<p>A simpler answer and modification I saw from <a href=\"https://stackoverflow.com/questions/43432409/multiple-regex-matches-in-google-sheets-formula\">here</a></p>\n<pre><code>=transpose(split(join(&quot;,&quot;,REGEXEXTRACT(A1,REGEXREPLACE(A1,&quot;(https[^,]+)&quot;,&quot;($1)&quot;))), &quot;,&quot;))\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/ejfLh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ejfLh.png\" alt=\"enter image description here\" /></a></p>\n<p>You can opt to remove transpose, I just used it to show the result clearly.</p>\n"}], "is_answered": true, "answer_count": 3, "last_activity_date": 1624387668, "question_id": 68087774, "title": "Spreadsheet clean text and split by regex", "body": "<p>I have this string:</p>\n<pre><code>Engaged View Beacon Url: https://ad.doubleclick.net/ddm/trackimp/..., Dcm Beacon Url: https://ad.doubleclick.net/ddm/trackimp/.....\n</code></pre>\n<p>I try to extract the two urls from it.</p>\n<p>I have tried this, but I get only the first url. Why? How can I improve this?</p>\n<pre><code>=SPLIT(REGEXREPLACE(REGEXREPLACE(F21, &quot;Dcm Beacon Url: &quot;, &quot;\u2665&quot;), &quot;Engaged View Beacon Url: &quot;, &quot;&quot;), &quot;\u2665&quot;)\n</code></pre>\n"}