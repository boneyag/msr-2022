{"tags": ["php", "regex"], "comments": [{"post_id": 68418160, "comment_id": 120915489, "body": "You may need to write an expression parser to get this behavior."}, {"post_id": 68418160, "comment_id": 120915500, "body": "Regex is evaluated from left to right. You cannot make it move back and forth. You can get the matches from regex and later do some post processing to get desired result."}, {"post_id": 68418160, "comment_id": 120915506, "body": "Not sure if <a href=\"https://stackoverflow.com/questions/14952113/how-can-i-match-nested-brackets-using-regex\" title=\"how can i match nested brackets using regex\">stackoverflow.com/questions/14952113/&hellip;</a> helps."}, {"post_id": 68418160, "comment_id": 120915528, "body": "Maybe <code>preg_match_all(&#39;&#47;[^][,]+&#47;&#39;, $commands, $matches)</code>?"}], "answers": [{"answer_id": 68418312, "question_id": 68418160, "body": "<p>You can use this below code.</p>\n<pre><code>$commands = &quot;[CMD1,[CMD2],[CMD3,[CMD7],[CMD4],[CMD5]]]&quot;;\n$array = explode(&quot;,&quot;, $commands);\n\narray_walk($array, function(&amp;$val, $key){\n     $val = trim( trim($val,&quot;]&quot;) ,&quot;[&quot;);\n});\n\nrsort($array);\n\nprint_r($array);\n</code></pre>\n<p>Output will be:</p>\n<pre><code>Array\n(\n    [0] =&gt; CMD7\n    [1] =&gt; CMD5\n    [2] =&gt; CMD4\n    [3] =&gt; CMD3\n    [4] =&gt; CMD2\n    [5] =&gt; CMD1\n)\n</code></pre>\n"}, {"answer_id": 68418457, "question_id": 68418160, "body": "<p>You can use</p>\n<pre class=\"lang-php prettyprint-override\"><code>preg_match_all('/[^][,]+/', $commands, $matches)\n</code></pre>\n<p>See the <a href=\"https://regex101.com/r/1KFPqv/1\" rel=\"nofollow noreferrer\">regex demo</a>. The <code>[^][,]+</code> regex matches one or more occurrences of any char other than <code>]</code>, <code>[</code> and <code>,</code>.</p>\n<p>Since the regex engine processes the string (i.e. searched for pattern matches) from left to right, you cannot get the matches in the order you specified in the question. If you want to reverse them, use <code>rsort</code>.</p>\n<p>See <a href=\"https://3v4l.org/I1GIo\" rel=\"nofollow noreferrer\">this PHP demo</a>:</p>\n<pre class=\"lang-php prettyprint-override\"><code>$commands = &quot;[CMD1,[CMD2],[CMD3,[CMD4],[CMD5]]]&quot;;\nif (preg_match_all('/[^][,]+/', $commands, $matches)) {\n    $array = $matches[0];\n    rsort($array);\n    print_r($array);\n}\n// =&gt; Array( [0] =&gt; CMD5 [1] =&gt; CMD4  [2] =&gt; CMD3 [3] =&gt; CMD2 [4] =&gt; CMD1 )\n</code></pre>\n"}], "is_answered": true, "answer_count": 2, "last_activity_date": 1626507652, "question_id": 68418160, "title": "PHP get text within brackets deep", "body": "<p>I have text like this between brackets [ and ]:</p>\n<pre><code>$commands = &quot;[CMD1,[CMD2],[CMD3,[CMD4],[CMD5]]]&quot;;\n</code></pre>\n<p>and execute with this PHP function:</p>\n<pre><code>preg_match_all('/\\\\[(.*?)\\\\]/', $commands, $matches);\n</code></pre>\n<p>And output of index 1 is:</p>\n<pre><code>array(2) (\n    ...\n    1 =&gt; array(3) (\n        0 =&gt; string(10) &quot;CMD1,[CMD2&quot;\n        1 =&gt; string(10) &quot;CMD3,[CMD4&quot;\n        2 =&gt; string(4) &quot;CMD5&quot;\n    )\n)\n</code></pre>\n<p>however I want to process the deepest one first, output like this:</p>\n<pre><code>array(2) (\n    ...\n    1 =&gt; array(3) (\n        0 =&gt; string(4) &quot;CMD5&quot;\n        1 =&gt; string(4) &quot;CMD4&quot;\n        2 =&gt; string(4) &quot;CMD3&quot;\n        3 =&gt; string(4) &quot;CMD2&quot;\n        4 =&gt; string(4) &quot;CMD1&quot;\n    )\n)\n</code></pre>\n<p>Can preg_match_all do that?</p>\n"}