{"tags": ["php", "json", "jwt"], "comments": [{"post_id": 68369739, "comment_id": 120832237, "body": "What information are you missing so that you would not guess any longer but know? What is your rationale behind using file_get_contens() on the file to read the key out of it? Hitting and hitting it again until it does not move any longer?"}, {"post_id": 68369739, "comment_id": 120833032, "body": "The &quot;alphanumeric sequence&quot; in your .key file is not the actual key, but a textual (base64 encoded) representation of binary data."}], "answers": [{"answer_id": 68369886, "question_id": 68369739, "body": "<p>In this context, the secret key is a password (a string) rather than a private key file.</p>\n<p>Check out this for example, they simply use the password 'secret'. Any string should make your code work.</p>\n<p><a href=\"https://www.php.net/manual/en/function.hash-hmac.php\" rel=\"nofollow noreferrer\">https://www.php.net/manual/en/function.hash-hmac.php</a></p>\n"}], "is_answered": true, "answer_count": 1, "last_activity_date": 1626214594, "question_id": 68369739, "title": "PHP - read a private key file &quot;.key&quot; to use for JWT", "body": "<p>I have a private key file <code>$formatPrivateKey</code> that I need to use as a variable</p>\n<pre><code>$privateKey =  file_get_contents('27660275_website.com.key');\n\n$signature = hash_hmac('sha256', $base64UrlHeader . &quot;.&quot; . $base64UrlPayload, $privateKey, true);\n</code></pre>\n<p>I need this to generate a client-assertion JWT.</p>\n<p>However, I'm getting the following error - <code>{&quot;error&quot;:&quot;invalid_request&quot;,&quot;error_description&quot;:&quot;The Token's Signature resulted invalid when verified using the Algorithm: SHA256withRSA&quot;}</code></p>\n<p>I guess I'm not reading the <code>file_get_contents('27660275_website.com.key')</code> properly.</p>\n<p>My <code>$privateKey</code> file starts with the following <code>-----BEGIN RSA PRIVATE KEY-----</code> and finishes with <code>-----END RSA PRIVATE KEY----</code>. I tried to remove them but I still got the same output.</p>\n<p>I tried to concatenate the alphanumeric sequence as suggested in another answer to a question in Stackoverflow. However, it didn't work.</p>\n<p>Therefore my assumption that I'm not reading <code>file_get_contents('27660275_website.com.key')</code> properly.</p>\n"}