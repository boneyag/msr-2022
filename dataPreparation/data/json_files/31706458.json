{"tags": ["json", "swift", "api"], "comments": [{"score": 0, "creation_date": 1438188486, "post_id": 31706458, "comment_id": 51351272, "body": "Your request is asynchrone. So you can&#39;t return data that way."}, {"score": 0, "creation_date": 1438188679, "post_id": 31706458, "comment_id": 51351395, "body": "you can help me with this or not??"}], "answers": [{"score": 0, "last_activity_date": 1438190579, "answer_id": 31707148, "question_id": 31706458, "body": "<p>This is a faulty design. You should NOT do it this way. Your <code>getApi()</code> method should have a success block which would be executed if the response was successful. Here is one possible solution:</p>\n\n<pre><code>static func getApi(success:( (data:NSArray) -&gt; () )) {\n\n    let user:String = \"user\"\n    let password:String = \"password\"\n\n    Alamofire.request(.GET, \"http://localhost/api/\")\n        .authenticate(user: user, password: password)\n        .responseJSON{ (request, response, jsonData, error) in\n\n            if let jsonData1 = jsonData {\n\n                if let jsonData2 = JSON(jsonData1).dictionaryObject {\n\n                    success(jsonData2 as! NSArray)\n\n                }\n\n            }\n\n    }\n\n    return data\n\n}\n</code></pre>\n\n<p>So, if you want to print the response, you'll do something like:</p>\n\n<pre><code>APIManager.getApi {\n println($0)\n}\n</code></pre>\n"}, {"score": 0, "last_activity_date": 1539878024, "answer_id": 52877992, "question_id": 31706458, "body": "<p>using URLSession you can write your APIManager class like this</p>\n\n<pre><code>import UIKit\nimport SwiftyJSON\n\nclass APIManager: NSObject {\n\n    let baseURL = \"https://jsonplaceholder.typicode.com\"\n    static let sharedInstance = APIManager()\n    static let getPostsEndpoint = \"/posts/\"\n\n    func getPostWithId(postId: Int, onSuccess: @escaping(JSON) -&gt; Void, onFailure: @escaping(Error) -&gt; Void){\n        let url : String = baseURL + APIManager.getPostsEndpoint\n        let request: NSMutableURLRequest = NSMutableURLRequest(url: NSURL(string: url)! as URL)\n        request.httpMethod = \"GET\"\n        print(\"Request \",request)\n        let session = URLSession.shared\n        let task = session.dataTask(with: request as URLRequest, completionHandler: {data, response, error -&gt; Void in\n            if(error != nil){\n                onFailure(error!)\n            } else{\n                do {\n                    let data = try JSON(data: data!)\n                    print(\"\\n Success data \",data)\n                    onSuccess(data)\n                } catch let error as NSError {\n                    print(\"Error \",error)\n                }\n            }\n        })\n        task.resume()\n    }\n}\n</code></pre>\n\n<p>// and to use write definition for api call and response in your controller as follows</p>\n\n<pre><code>func getGETAPIData(){\n        APIManager.sharedInstance.getPostWithId(postId:1, onSuccess: { json in\n            DispatchQueue.main.async {\n                print(\"data in list view:\",String(describing: json))\n            }\n        }, onFailure: { error in\n            print(\"error2 :\")\n        })\n    }\n</code></pre>\n\n<p>// and call this method as</p>\n\n<pre><code>self.getGETAPIData()\n</code></pre>\n"}], "is_answered": false, "answer_count": 2, "score": 0, "last_activity_date": 1539878024, "creation_date": 1438188399, "question_id": 31706458, "title": "Json Api Manager in Swift", "body": "<p>Hi there i am currently working on a Api Manager in Swift, what i got so far:</p>\n\n<pre><code>import Foundation\nimport CoreData\nimport Alamofire\nimport SwiftyJSON\n\nclass ApiManager {\n\n    var data: NSArray = []\n\n    func getApi() -&gt; NSArray {\n\n        let user:String = \"user\"\n        let password:String = \"password\"\n\n        Alamofire.request(.GET, \"http://localhost/api/\")\n            .authenticate(user: user, password: password)\n            .responseJSON{ (request, response, jsonData, error) in\n\n                if let jsonData1 = jsonData {\n\n                    if let jsonData2 = JSON(jsonData1).dictionaryObject {\n\n                        self.data = jsonData2[\"data\"] as! NSArray\n\n                    }\n\n                }\n\n        }\n\n        return data\n\n    }\n\n}\n</code></pre>\n\n<p>The JSON Api is correct, but there is something wrong with my swift code, but i am not sure what it is,</p>\n\n<p>When i call this manager:</p>\n\n<pre><code>let response = ApiManager().getApi()\nprintln(response)\n</code></pre>\n\n<p>I just get empty brackets:</p>\n\n<pre><code>(\n)\n</code></pre>\n\n<p>Anybody could help me with this?</p>\n"}