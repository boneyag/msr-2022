{"tags": ["python", "json", "discord", "discord.py", "bots"], "answers": [{"score": 1, "last_activity_date": 1623915888, "answer_id": 68015006, "question_id": 68010629, "body": "<p>That's probably because it reacts to its own messages. To prevent <code>on_message</code> from executing when the message author is the bot itself you can add simple if statement on the start of event. Like this:</p>\n<pre class=\"lang-py prettyprint-override\"><code>async def on_message(message):\n    if message.author == bot.user:\n        return\n</code></pre>\n"}], "is_answered": true, "answer_count": 1, "score": -1, "last_activity_date": 1623915888, "creation_date": 1623881657, "question_id": 68010629, "title": "discord.py get embed image url and check if it exists in json file", "body": "<p>so as the title says i'm trying to check if a message.embeds[0].image.url exists inside my json file, this is my code</p>\n<pre><code>import discord\nimport json\nfrom datetime import datetime\n\nbot = commands.Bot(command_prefix = commands.when_mentioned_or('n.')\njs = open(&quot;file.json&quot;,&quot;r&quot;)\ndata= json.load(js)\n\n@bot.event\nasync def on_ready():\n    print('Bot is online') \n\n@bot.event\nasync def on_message(message):\n    if len(message.embeds) == 0:\n         return\n    elif message.embeds[0].image.url in data[&quot;group&quot;]:\n         embed=discord.Embed(message.embeds[0].color)\n         embed.add_field(name=&quot;Server&quot;, value=message.server)\n         embed.add_field(name=&quot;Channel&quot;, value=message.channel)\n         embed.add_field(name=&quot;Time&quot;, value=datetime.now().strftime('%H:%M:%S on %x'))\n         embed.set_image(url=message.embeds[0].image.url)\n         channel = bot.get_channel(854710154045292565)\n         await channel.send(embed=embed)\n    else:\n         return\n\nbot.run('token')\n</code></pre>\n<p>and this is how my json file is like</p>\n<pre><code>{\n    &quot;group&quot;:\n    [\n    {\n    &quot;subgroup1&quot;:[&quot;url1&quot;,&quot;url2&quot;,&quot;url3&quot;,&quot;url4&quot;,&quot;url5&quot;],\n    &quot;subgroup2&quot;:[&quot;url1&quot;,&quot;url2&quot;,&quot;url3&quot;,&quot;url4&quot;,&quot;url5&quot;],\n    &quot;subgroup3&quot;:[&quot;url1&quot;,&quot;url2&quot;,&quot;url3&quot;,&quot;url4&quot;,&quot;url5&quot;],\n     ...\n    &quot;subgroupX&quot;:[&quot;url1&quot;,&quot;url2&quot;,&quot;url3&quot;,&quot;url4&quot;,&quot;url5&quot;]\n    }\n    ]\n}\n</code></pre>\n<p>i tried testing it with urls that i already had in my json file and it seems to work even though i'm not sure, but the problem is that the bot keeps sending the embedded message infinite times until it's closed.</p>\n"}