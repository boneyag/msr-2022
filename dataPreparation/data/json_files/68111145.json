{"tags": ["python", "django", "django-rest-framework", "cors", "django-cors-headers"], "comments": [{"score": 1, "creation_date": 1624729620, "post_id": 68111145, "comment_id": 120439841, "body": "Have you tried moving CorsMiddleware up? Try switching it to the second item in  MIDDLEWARE.  It should be a close as possible to beginning of the list."}], "answers": [{"score": -1, "last_activity_date": 1625090310, "answer_id": 68202031, "question_id": 68111145, "body": "<p>You also need <code>CORS_ALLOW_CREDENTIALS</code> as django requires CSRF cookies to validate the requests.</p>\n<blockquote>\n<p>If True, cookies will be allowed to be included in cross-site HTTP requests. Defaults to False. Note: in Django 2.1 the SESSION_COOKIE_SAMESITE setting was added, set to 'Lax' by default, which will prevent Django\u2019s session cookie being sent cross-domain. Change it to None to bypass this security restriction.</p>\n</blockquote>\n"}, {"score": -1, "last_activity_date": 1626461716, "answer_id": 68414062, "question_id": 68111145, "body": "<p>I found my bug. I didn't understood the error message properly\nI focused on first half of error message but the later half was clearly pointing to different issue\nThe important 0art of error  was :</p>\n<p>&quot;Request header field access-control-allow-origin is not allowed by Access-Control-Allow-Headers in preflight response&quot;</p>\n<p>In my desperate attempts to solve the issue, my first reaction was to provide a cors header in my http request like this</p>\n<p>headers: {\n'Access-Control-Allow-Origin': '*',\n}</p>\n<p>Which was wrong as it I was sending custom header and as the message states quite clearly &quot;this was not allowed&quot;!</p>\n<p>Just removing this one line from my request solved the issue.</p>\n"}], "is_answered": false, "answer_count": 2, "score": 1, "last_activity_date": 1626461716, "creation_date": 1624518885, "question_id": 68111145, "title": "Django CORS issue: access-control-allow-origin is not allowed", "body": "<p>I'm getting following error:</p>\n<p><code>Access to XMLHttpRequest at 'http://127.0.0.1:8000/' from origin 'http://localhost:62570' has been blocked by CORS policy: Request header field access-control-allow-origin is not allowed by Access-Control-Allow-Headers in preflight response.</code></p>\n<p>I have tried adding <a href=\"https://pypi.org/project/django-cors-headers/\" rel=\"nofollow noreferrer\">django-cors-headers</a> middleware and <code>CORS_ALLOW_ALL_ORIGINS = True</code> and  I have also made <code>ALLOWED_HOSTS = ['*']</code> but still getting same CORS error.\nI had the same error with NestJS but after adding <code>app.enableCors();</code> it got resolved.</p>\n<p>Here is my <code>settings.py</code> file:</p>\n<pre class=\"lang-py prettyprint-override\"><code>from pathlib import Path\n\nBASE_DIR = Path(__file__).resolve(strict=True).parent.parent\nDEBUG = True\n\nALLOWED_HOSTS = ['*']\n\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'corsheaders',\n    'rest_framework',\n]\n\nMIDDLEWARE = [\n    'corsheaders.middleware.CorsMiddleware',\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\nROOT_URLCONF = 'basic_app.urls'\nTEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [],\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n\nWSGI_APPLICATION = 'basic_app.wsgi.application'\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.sqlite3',\n        'NAME': BASE_DIR / 'db.sqlite3',\n    }\n}\nAUTH_PASSWORD_VALIDATORS = [\n    {\n        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',\n    },\n]\nLANGUAGE_CODE = 'en-us'\nTIME_ZONE = 'UTC'\nUSE_I18N = True\nUSE_L10N = True\nUSE_TZ = True\nSTATIC_URL = '/static/'\n\n# CORS\nCORS_ALLOW_ALL_ORIGINS = True\n\n# CORS_ALLOWED_ORIGINS = [\n#     &quot;http://localhost:62570&quot;,\n#     &quot;https://example.com&quot;,\n#     &quot;https://sub.example.com&quot;,\n#     &quot;http://localhost:8080&quot;,\n#     &quot;http://127.0.0.1:9000&quot;\n# ]\n</code></pre>\n"}