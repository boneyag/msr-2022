{"tags": ["regex", "google-apps-script", "google-sheets", "google-sheets-formula", "gs-conditional-formatting"], "comments": [{"score": 0, "creation_date": 1572438886, "post_id": 58625145, "comment_id": 103558554, "body": "You can use filter the data and copy paste in new sheet. hope you understand my point ."}, {"score": 0, "creation_date": 1572439923, "post_id": 58625145, "comment_id": 103559159, "body": "How many rows of data do you have? 3,000 columns is a fair bit, just for single row. The <code>match</code> function would work, but recalculation time could be an issue. If you are going to delete the row anyway, I&#39;d opt for a script that detects &quot;na&quot; then deletes the row"}], "answers": [{"score": 1, "last_activity_date": 1572439554, "answer_id": 58625703, "question_id": 58625145, "body": "<p>This answer based on what I understand, sorry if I'm wrong. You can use conditional formatting to highlight all NA text \n<a href=\"https://i.stack.imgur.com/7QDVb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7QDVb.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is what rules I used </p>\n\n<p><a href=\"https://i.stack.imgur.com/Nh42Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nh42Z.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here are another answers that may help you </p>\n\n<ol>\n<li><p><a href=\"https://stackoverflow.com/questions/11058019/delete-a-row-in-google-spreadsheets-if-value-of-cell-in-said-row-is-0-or-blank\">Delete a row in Google Spreadsheets if value of cell in said row is 0 or blank</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/44643965/google-sheets-delete-rows-containing-specified-data\">Google Sheets: delete rows containing specified data</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/46112422/deleting-cells-in-google-sheets-without-removing-a-whole-row\">Deleting Cells in Google Sheets without removing a whole row</a></p></li>\n</ol>\n\n<p>Sorry for bad English.</p>\n"}, {"score": 1, "last_activity_date": 1572455317, "answer_id": 58630519, "question_id": 58625145, "body": "<p>I'm not sure if my understing is well but see below what you can do.\nThis is a google script function which color the whole column where \"na\" is in</p>\n\n<pre><code>  function myFunction() {\n//get the spreadsheet where the function is running\n  var ss = SpreadsheetApp.getActive()\n  //Replace \"the name of your sheet\" by your sheet name\" be careful its case sensitive.\n  var sheet = ss.getSheetByName(\"The name of your sheet\")\n  //Get all your data as an array (If your sheet has no header, change 2 by 1 and (sheet.getLastRow()-1) by sheet.getLastRow())\n  var values = sheet.getRange(2,1,(sheet.getLastRow()-1), sheet.getLastColumn()).getValues();\n\n  //For each column\n  for (var i = 0; i&lt; sheet.getLastColumn(); i++){\n  //using function map is helping to select one column by one column\n    var mapValues = values.map(function(r){return r[i]});\n    //Searching your keyword in the column, in your case it's \"na\"\n    var position = mapValues.indexOf(\"Put the string that you are looking for, in your case 'na'\");\n    //if at least there is one \"na\" inside the column\n    if( position &gt;-1){\n    //then this color have to get red color as a background\n       var wholeColumn = sheet.getRange(2,(i+1),(sheet.getLastRow()-1));\n       wholeColumn.setBackground(\"red\");\n    }\n  }\n}``\n</code></pre>\n\n<p>Let me know if it works</p>\n"}, {"comments": [{"score": 1, "creation_date": 1572479266, "post_id": 58633328, "comment_id": 103577054, "body": "Thank you again @player0, once more you were able to help me thanks ! as long as they are highlighted I can just filter them by color and delete them. Thank you so much!"}, {"score": 0, "creation_date": 1572535363, "post_id": 58633328, "comment_id": 103598098, "body": "Hello, I ran the command and it has been highlighting the rows but it has only done 200 rows out of 7000. It has been already around 5 hours that I have left google sheets on. Is there any way to speed it up?"}, {"score": 1, "creation_date": 1572536791, "post_id": 58633328, "comment_id": 103598841, "body": "can you share a copy of your sheet?"}, {"score": 1, "creation_date": 1572546197, "post_id": 58633328, "comment_id": 103603187, "body": "can you try like this? <a href=\"https://docs.google.com/spreadsheets/d/1ud1QUq0fliq_I-SFV6cWvMp2ssKRMLbgEsxGS2yeOgo/copy\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a>"}, {"score": 1, "creation_date": 1572549319, "post_id": 58633328, "comment_id": 103604598, "body": "That&#39;s exactly what I was looking for, I don&#39;t know why my computer kept on taking forever to even highlight certain rows. You are a life saver."}], "score": 2, "last_activity_date": 1572468051, "answer_id": 58633328, "question_id": 58625145, "body": "<p>you can use this formula to color all <code>na</code> rows:</p>\n\n<pre><code>=ARRAYFORMULA(REGEXMATCH(TRANSPOSE(QUERY(TRANSPOSE($A1:$Z),,999^99)), \" na \"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vBBVL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vBBVL.png\" alt=\"0\"></a></p>\n"}], "is_answered": true, "answer_count": 3, "score": 1, "last_activity_date": 1572546364, "creation_date": 1572437624, "question_id": 58625145, "title": "Removing a row containing a specific text in Google Sheets", "body": "<p>I have a data set of around 3000 columns, but some of the columns have several cells that contain cells \"na\". These rows have no importance since they don't have data that I will need, is there a command in google sheets that can either highlight the entire row that contains that text or delete the entire row containing that text?</p>\n\n<p>Any help would be appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SDBul.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SDBul.png\" alt=\"Example of columns that have &lt;code&gt;na&lt;/code&gt; in cells, the row must be deleted\"></a></p>\n\n<p><a href=\"https://docs.google.com/spreadsheets/d/1u8OUfQOzgAulf1a8bzQ8SB5sb5Uvb1I4amF5sdGEBlc/edit?usp=sharing\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1u8OUfQOzgAulf1a8bzQ8SB5sb5Uvb1I4amF5sdGEBlc/edit?usp=sharing</a></p>\n\n<p>My document ^.</p>\n"}